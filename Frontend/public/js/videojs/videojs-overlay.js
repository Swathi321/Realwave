(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.videojsOverlay=f()}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(global){if(typeof window!=="undefined"){module.exports=window;}else if(typeof global!=="undefined"){module.exports=global;}else if(typeof self!=="undefined"){module.exports=self;}else{module.exports={};}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(require,module,exports){module.exports=function tsmlj(ts){var out='';var i=0;for(;i<arguments.length;i++){out+=ts[i]+(arguments[i+1]||'');}
return out.replace(/\s+/g,' ').trim();};},{}],3:[function(require,module,exports){(function(global){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=(function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};})();var _get=function get(_x,_x2,_x3){var _again=true;_function:while(_again){var object=_x,property=_x2,receiver=_x3;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{_x=parent;_x2=property;_x3=receiver;_again=true;desc=parent=undefined;continue _function;}}else if('value'in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}}};var _templateObject=_taggedTemplateLiteral(['\n      created, listening to "','" for "start" and\n      "','" for "end"\n    '],['\n      created, listening to "','" for "start" and\n      "','" for "end"\n    ']),_templateObject2=_taggedTemplateLiteral(['\n          hiding; ',' is an integer and overlay should not show at this time\n        '],['\n          hiding; ',' is an integer and overlay should not show at this time\n        ']),_templateObject3=_taggedTemplateLiteral(['\n          hiding; show point (',') is before now (',') and end\n          point (',') is an event\n        '],['\n          hiding; show point (',') is before now (',') and end\n          point (',') is an event\n        ']);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{'default':obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function');}}
function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
var _tsmlj=require('tsmlj');var _tsmlj2=_interopRequireDefault(_tsmlj);var _videoJs=(typeof window!=="undefined"?window['videojs']:typeof global!=="undefined"?global['videojs']:null);var _videoJs2=_interopRequireDefault(_videoJs);var _globalWindow=require('global/window');var _globalWindow2=_interopRequireDefault(_globalWindow);var defaults={align:'top-left','class':'',content:'This overlay will show up while the video is playing',debug:false,showBackground:true,attachToControlBar:false,overlays:[{start:'playing',end:'paused'}]};var Component=_videoJs2['default'].getComponent('Component');var dom=_videoJs2['default'].dom||_videoJs2['default'];var registerPlugin=_videoJs2['default'].registerPlugin||_videoJs2['default'].plugin;var isNumber=function isNumber(n){return typeof n==='number'&&n===n;};var hasNoWhitespace=function hasNoWhitespace(s){return typeof s==='string'&&/^\S+$/.test(s);};var Overlay=(function(_Component){_inherits(Overlay,_Component);function Overlay(player,options){var _this=this;_classCallCheck(this,Overlay);_get(Object.getPrototypeOf(Overlay.prototype),'constructor',this).call(this,player,options);['start','end'].forEach(function(key){var value=_this.options_[key];if(isNumber(value)){_this[key+'Event_']='timeupdate';}else if(hasNoWhitespace(value)){_this[key+'Event_']=value;}else if(key==='start'){throw new Error('invalid "start" option; expected number or string');}});['endListener_','rewindListener_','startListener_'].forEach(function(name){_this[name]=function(e){return Overlay.prototype[name].call(_this,e);};});if(this.startEvent_==='timeupdate'){this.on(player,'timeupdate',this.rewindListener_);}
this.debug((0,_tsmlj2['default'])(_templateObject,this.startEvent_,this.endEvent_||'nothing'));this.hide();}
_createClass(Overlay,[{key:'createEl',value:function createEl(){var options=this.options_;var content=options.content;var background=options.showBackground?'vjs-overlay-background':'vjs-overlay-no-background';var el=dom.createEl('div',{className:'\n        vjs-overlay\n        vjs-overlay-'+options.align+'\n        '+options['class']+'\n        '+background+'\n        vjs-hidden\n      '});if(typeof content==='string'){el.innerHTML=content;}else if(content instanceof _globalWindow2['default'].DocumentFragment){el.appendChild(content);}else{dom.appendContent(el,content);}
return el;}},{key:'debug',value:function debug(){if(!this.options_.debug){return;}
var log=_videoJs2['default'].log;var fn=log;for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
if(log.hasOwnProperty(args[0])&&typeof log[args[0]]==='function'){fn=log[args.shift()];}
fn.apply(undefined,['overlay#'+this.id()+': '].concat(args));}},{key:'hide',value:function hide(){_get(Object.getPrototypeOf(Overlay.prototype),'hide',this).call(this);this.debug('hidden');this.debug('bound `startListener_` to "'+this.startEvent_+'"');if(this.endEvent_){this.debug('unbound `endListener_` from "'+this.endEvent_+'"');this.off(this.player(),this.endEvent_,this.endListener_);}
this.on(this.player(),this.startEvent_,this.startListener_);return this;}},{key:'shouldHide_',value:function shouldHide_(time,type){var end=this.options_.end;return isNumber(end)?time>=end:end===type;}},{key:'show',value:function show(){_get(Object.getPrototypeOf(Overlay.prototype),'show',this).call(this);this.off(this.player(),this.startEvent_,this.startListener_);this.debug('shown');this.debug('unbound `startListener_` from "'+this.startEvent_+'"');if(this.endEvent_){this.debug('bound `endListener_` to "'+this.endEvent_+'"');this.on(this.player(),this.endEvent_,this.endListener_);}
return this;}},{key:'shouldShow_',value:function shouldShow_(time,type){var start=this.options_.start;var end=this.options_.end;if(isNumber(start)){if(isNumber(end)){return time>=start&&time<end;}else if(!this.hasShownSinceSeek_){this.hasShownSinceSeek_=true;return time>=start;}
return Math.floor(time)===start;}
return start===type;}},{key:'startListener_',value:function startListener_(e){var time=this.player().currentTime();if(this.shouldShow_(time,e.type)){this.show();}}},{key:'endListener_',value:function endListener_(e){var time=this.player().currentTime();if(this.shouldHide_(time,e.type)){this.hide();}}},{key:'rewindListener_',value:function rewindListener_(e){var time=this.player().currentTime();var previous=this.previousTime_;var start=this.options_.start;var end=this.options_.end;if(time<previous){this.debug('rewind detected');if(isNumber(end)&&!this.shouldShow_(time)){this.debug((0,_tsmlj2['default'])(_templateObject2,end));this.hasShownSinceSeek_=false;this.hide();}else if(hasNoWhitespace(end)&&time<start){this.debug((0,_tsmlj2['default'])(_templateObject3,start,time,end));this.hasShownSinceSeek_=false;this.hide();}}
this.previousTime_=time;}}]);return Overlay;})(Component);_videoJs2['default'].registerComponent('Overlay',Overlay);var plugin=function plugin(options){var _this2=this;var settings=_videoJs2['default'].mergeOptions(defaults,options);if(Array.isArray(this.overlays_)){this.overlays_.forEach(function(overlay){_this2.removeChild(overlay);if(_this2.controlBar){_this2.controlBar.removeChild(overlay);}
overlay.dispose();});}
var overlays=settings.overlays;delete settings.overlays;this.overlays_=overlays.map(function(o){var mergeOptions=_videoJs2['default'].mergeOptions(settings,o);if(mergeOptions.attachToControlBar&&_this2.controlBar&&mergeOptions.align.indexOf('bottom')!==-1){return _this2.controlBar.addChild('overlay',mergeOptions);}
return _this2.addChild('overlay',mergeOptions);});};plugin.VERSION='1.1.4';registerPlugin('overlay',plugin);exports['default']=plugin;module.exports=exports['default'];}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"global/window":1,"tsmlj":2}]},{},[3])(3)});